(function(t){function e(e){for(var n,i,s=e[0],r=e[1],u=e[2],d=0,m=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);l&&l(e);while(m.length)m.shift()();return c.push.apply(c,u||[]),a()}function a(){for(var t,e=0;e<c.length;e++){for(var a=c[e],n=!0,s=1;s<a.length;s++){var r=a[s];0!==o[r]&&(n=!1)}n&&(c.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},o={app:0},c=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],r=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=r;c.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},2107:function(t,e,a){},"469e":function(t,e,a){"use strict";var n=a("2107"),o=a.n(n);o.a},"5c0b":function(t,e,a){"use strict";var n=a("9c0c"),o=a.n(n);o.a},"68ea":function(t,e,a){},"6c02":function(t){t.exports=JSON.parse('["9781408855652","9781408855669","9781408855676","9781408855683","9781408855690","9781408855706","9781408855713"]')},7159:function(t,e,a){"use strict";var n=a("e223"),o=a.n(n);o.a},8069:function(t,e,a){"use strict";var n=a("f694"),o=a.n(n);o.a},"9ae0":function(t,e,a){"use strict";var n=a("cc84"),o=a.n(n);o.a},"9c0c":function(t,e,a){},cc84:function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=a("1881"),c=a.n(o),i=(a("96cf"),a("1da1")),s=a("2f62"),r=(a("d81d"),a("d3b7"),a("5530")),u=a("d4ec"),l=function t(e,a,n,o){Object(u["a"])(this,t),this.id=e,this.cover=a,this.title=n,this.price=parseFloat(o)},d=l,m={getBooks:function(){return Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,n,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="It seems there is a problem getting all the books. Please contact admin.",a=new Headers,a.append("Accept","application/json"),a.append("Content-Type","application/json"),t.prev=4,n=new Request("https://api.jsonbin.io/b/5c52a1be15735a25423d3540",Object(r["a"])({method:"GET"},a)),t.next=8,window.fetch(n);case 8:if(o=t.sent,200===o.status){t.next=11;break}throw new Error(e);case 11:return t.next=13,o.json();case 13:return c=t.sent,t.abrupt("return",c.books.map((function(t){return new d(t.id,t.cover,t.title,t.price)})));case 17:throw t.prev=17,t.t0=t["catch"](4),new Error(e);case 20:case"end":return t.stop()}}),t,null,[[4,17]])})))()}},f=m,v=(a("c740"),a("13d5"),a("a434"),a("2909")),p={getTotal:function(t){return t.map((function(t){return t.price})).reduce((function(t,e){return t+e}),0)}},b=p,k=(a("4de4"),a("caad"),a("45fc"),a("2532"),a("6c02")),h=[0,0,.1,.11,.12,.13,.14,.15],g=function(t){return t>=h.length?h[h.length-1]:h[t]},_={getTotalDiscount:function(t){var e=t.filter((function(t){return k.includes(t.id)})),a=e.reduce((function(t,e){var a=t.some((function(t){return t.id===e.id}));return a||t.push(e),t}),[]),n=g(a.length),o=a.reduce((function(t,e){return t+e.price}),0),c=o*n;return c}},C=_,y={addBook:function(t,e){var a=Object(v["a"])(e);return a.push(t),a},removeBook:function(t,e){var a=Object(v["a"])(e),n=a.findIndex((function(e){return e.id===t.id}));return-1===n?a:(a.splice(n,1),a)},getTotalBeforeDiscount:function(t){return b.getTotal(t)},getTotalDiscount:function(t){return C.getTotalDiscount(t)},getTotalAfterDiscount:function(t){var e=b.getTotal(t),a=C.getTotalDiscount(t);return e-a},getBasketItemSummary:function(t){return t.reduce((function(t,e){return t[e.id]?(t[e.id].quantity+=1,t[e.id].totalPrice+=e.price):t[e.id]={id:e.id,title:e.title,quantity:1,totalPrice:e.price},t}),{})}},B=y;n["a"].use(s["a"]);var O={state:{catalogue:[],catalogueError:"",basket:[]},mutations:{updateCatalogue:function(t,e){t.catalogue=e},updateCatalogueError:function(t,e){t.catalogueError=e},addBookToBasket:function(t,e){t.basket=B.addBook(e,t.basket)},removeBookFromBasket:function(t,e){t.basket=B.removeBook(e,t.basket)},clearBasket:function(t){t.basket=[]}},actions:{getCatalogue:function(t){var e=t.commit;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.getBooks();case 3:a=t.sent,e("updateCatalogue",a),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e("updateCatalogueError",t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},addBookToBasket:function(t,e){var a=t.commit;a("addBookToBasket",e)},removeBookFromBasket:function(t,e){var a=t.commit;a("removeBookFromBasket",e)},clearBasket:function(t){var e=t.commit;e("clearBasket")}}},j=new s["a"].Store(O),T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"parent"},[a("div",{staticClass:"header-container"},[t._v(" LITTLE BROWN BOOK SHOP ")]),a("div",{staticClass:"catalogue-container"},[a("Catalogue")],1),a("div",{staticClass:"basket-container"},[a("BasketPanel")],1)]),a("modals-container")],1)},D=[],w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"catalogue"},[t.catalogueError?a("div",{staticClass:"catalogue-error"},[t._m(0),t._v(" "+t._s(t.catalogueError)+" ")]):t._e(),t._l(t.catalogue,(function(t){return a("BookItem",{key:t.id,attrs:{book:t}})}))],2)},x=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("img",{attrs:{src:"/sad-sally.png",alt:"Error getting catalogue"}})])}],P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.book?a("div",{staticClass:"book-item",on:{click:function(){t.addBook(t.book)}}},[a("div",{staticClass:"book-item-cover"},[a("img",{attrs:{src:t.book.cover,alt:t.book.title}})]),a("div",[t._v(t._s(t.book.title))])]):t._e()},E=[],R=n["a"].extend({name:"BookItem",props:{book:{type:Object,required:!0}},methods:Object(r["a"])({},Object(s["b"])({addBookToBasket:"addBookToBasket"}),{addBook:function(t){this.addBookToBasket(t)}})}),I=R,$=(a("7159"),a("2877")),A=Object($["a"])(I,P,E,!1,null,"3a28f71a",null),S=A.exports,q=n["a"].extend({name:"Catalogue",components:{BookItem:S},computed:Object(r["a"])({},Object(s["c"])({catalogue:function(t){return t.catalogue},catalogueError:function(t){return t.catalogueError}})),methods:Object(r["a"])({},Object(s["b"])({getCatalogue:"getCatalogue"})),created:function(){this.getCatalogue()}}),F=q,N=(a("8069"),Object($["a"])(F,w,x,!1,null,"674a59c0",null)),M=N.exports,J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.processStarted?a("div",{staticClass:"basket-summary-container"},[a("div",{staticClass:"basket-item-list"},t._l(t.basket,(function(e,n){return a("div",{key:n,staticClass:"basket-item"},[a("div",{staticClass:"basket-item-title"},[t._v(t._s(e.title))]),a("div",[a("button",{on:{click:function(){t.removeBook(e)}}},[t._v(" - ")]),t._v(" x "+t._s(e.quantity)+" = "+t._s(e.totalPrice)+" ")])])})),0),a("div",{staticClass:"basket-total"},[a("TotalItem",{attrs:{label:"Total:",amount:t.totalPriceBeforeDiscount}}),a("TotalItem",{attrs:{label:"Discount:",amount:t.totalDiscount}}),a("TotalItem",{staticStyle:{"font-weight":"bold"},attrs:{label:"Net:",amount:t.totalAfterDiscount}})],1),a("div",{staticClass:"basket-action"},[a("button",{attrs:{disabled:!t.totalAfterDiscount},on:{click:function(){t.checkout()}}},[t._v(" Checkout ")])])]):a("div",{staticClass:"basket-start-hint"},[t._m(0),a("div",[t._v("Click on any book")]),a("div",[t._v("to start the checkout process")])])},H=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("img",{attrs:{src:"/basket_empty.png",alt:"empty"}})])}],L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"checkout"},[a("div",{staticClass:"checkout-title"},[t._v("Checkout")]),a("div",{staticClass:"checkout-item"},[a("div",{staticClass:"checkout-item-label"},[t._v("Total Payable")]),a("div",{staticClass:"checkout-item-amount"},[t._v(t._s(t.totalAfterDiscount))])]),a("div",{staticClass:"checkout-item"},[t._m(0),a("div",{staticClass:"checkout-item-amount"},[a("input",{directives:[{name:"model",rawName:"v-model.number.trim",value:t.amountReceived,expression:"amountReceived",modifiers:{number:!0,trim:!0}}],attrs:{id:"amountReceived",type:"number"},domProps:{value:t.amountReceived},on:{input:function(e){e.target.composing||(t.amountReceived=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}})])]),a("div",{staticClass:"checkout-item"},[a("div",{staticClass:"checkout-item-label"},[t._v("Changes")]),a("div",{staticClass:"checkout-item-amount"},[t._v(t._s(t.changes>0?t.changes:"-"))])]),a("div",{staticClass:"checkout-action"},[a("div",{staticClass:"checkout-action-item"},[a("button",{staticClass:"checkout-action-back",on:{click:function(){t.close()}}},[t._v(" Back ")])]),a("div",{staticClass:"checkout-action-item"},[a("button",{staticClass:"checkout-action-pay",attrs:{disabled:t.changes<0},on:{click:function(){t.pay()}}},[t._v(" Pay ")])])])])},G=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"checkout-item-label"},[a("label",{attrs:{for:"amountReceived"}},[t._v("Received")])])}],K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"receipt"},[a("div",{staticClass:"receipt-title"},[t._v("Invoice")]),a("div",{staticClass:"receipt-number"},[t._v("Invoice number: "+t._s(t.transaction.id))]),a("table",{staticClass:"receipt-item-list"},[t._m(0),a("tbody",t._l(t.transactionItems,(function(e,n){return a("tr",{key:n,staticClass:"receipt-item"},[a("td",{staticClass:"receipt-item-title"},[t._v(" "+t._s(e.title)+" ")]),a("td",{staticClass:"receipt-item-quantity"},[t._v(" "+t._s(e.quantity)+" ")]),a("td",{staticClass:"receipt-item-total"},[t._v(" "+t._s(e.totalPrice)+" ")])])})),0)]),a("table",{staticClass:"receipt-money"},[a("tbody",[a("tr",[a("td",[t._v("Total payable (before discount)")]),a("td",{staticClass:"receipt-money-total"},[t._v(t._s(t.transaction.amountPayableBeforeDiscount))])]),a("tr",[a("td",[t._v("Discount")]),a("td",{staticClass:"receipt-money-total"},[t._v(t._s(t.transaction.discount))])]),a("tr",[a("td",[t._v("Total payable (after discount)")]),a("td",{staticClass:"receipt-money-total"},[t._v(t._s(t.transaction.amountPayableAfterDiscount))])]),a("tr",[a("td",[t._v("Amount received")]),a("td",{staticClass:"receipt-money-total"},[t._v(t._s(t.transaction.amountReceived))])]),a("tr",[a("td",[t._v("Changes")]),a("td",{staticClass:"receipt-money-total"},[t._v(t._s(t.transaction.changes))])])])]),a("div",{staticClass:"receipt-thank-you"},[t._v("Thank you! Please come again.")]),a("div",{staticClass:"receipt-action"},[a("button",{staticClass:"receipt-action-close",on:{click:function(){t.reset()}}},[t._v(" Done ")])])])},Q=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"receipt-item"},[a("th",{staticClass:"receipt-item-title"},[t._v("Title")]),a("th",{staticClass:"receipt-item-quantity"},[t._v("Quantity")]),a("th",{staticClass:"receipt-item-total"},[t._v("Price")])])}],U=n["a"].extend({name:"Receipt",props:{transaction:{type:Object,required:!0}},computed:{transactionItems:function(){return B.getBasketItemSummary(this.transaction.books)}},methods:Object(r["a"])({},Object(s["b"])({clearBasket:"clearBasket"}),{reset:function(){this.$emit("close"),this.clearBasket()}})}),W=U,Y=(a("9ae0"),Object($["a"])(W,K,Q,!1,null,"7e7c6e4a",null)),z=Y.exports,V=function t(e,a,n,o,c,i,s){Object(u["a"])(this,t),this.id=Date.now(),this.books=e,this.amountPayableBeforeDiscount=a,this.discount=n,this.amountPayableAfterDiscount=o,this.amountReceived=c,this.changes=i,this.success=s},X=V,Z=n["a"].extend({name:"Checkout",data:function(){return{amountReceived:0}},computed:Object(r["a"])({},Object(s["c"])({basket:function(t){return t.basket},totalPriceBeforeDiscount:function(t){return B.getTotalBeforeDiscount(t.basket)},totalDiscount:function(t){return-1*B.getTotalDiscount(t.basket)},totalAfterDiscount:function(t){return B.getTotalAfterDiscount(t.basket)}}),{changes:function(){return this.amountReceived-this.totalAfterDiscount}}),methods:{close:function(){this.$emit("close")},pay:function(){this.close();var t=new X(this.basket,this.totalPriceBeforeDiscount,this.totalDiscount,this.totalAfterDiscount,this.amountReceived,this.changes,!0);this.$modal.show(z,{transaction:t},{width:"80%",height:"auto",scrollable:!0})}}}),tt=Z,et=(a("469e"),Object($["a"])(tt,L,G,!1,null,"255c5f81",null)),at=et.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"total-item"},[a("div",{staticClass:"total-item-label"},[t._v(t._s(t.label))]),a("div",{staticClass:"total-item-connector"}),a("div",{staticClass:"total-item-amount"},[t._v(t._s(t.amount))])])},ot=[],ct=(a("a9e3"),n["a"].extend({name:"TotalItem",props:{label:{type:String,required:!0},amount:{type:Number,required:!0}}})),it=ct,st=(a("ec91"),Object($["a"])(it,nt,ot,!1,null,"cbb1eb4c",null)),rt=st.exports,ut=n["a"].extend({name:"Basket",components:{TotalItem:rt},computed:Object(r["a"])({},Object(s["c"])({processStarted:function(t){return t.basket.length>0},basket:function(t){return B.getBasketItemSummary(t.basket)},totalPriceBeforeDiscount:function(t){return B.getTotalBeforeDiscount(t.basket)},totalDiscount:function(t){return-1*B.getTotalDiscount(t.basket)},totalAfterDiscount:function(t){return B.getTotalAfterDiscount(t.basket)}})),methods:Object(r["a"])({},Object(s["b"])({removeBookFromBasket:"removeBookFromBasket"}),{removeBook:function(t){this.removeBookFromBasket(t)},checkout:function(){this.$modal.show(at,{},{width:"100%",height:"70%",pivotY:1,scrollable:!0})}})}),lt=ut,dt=(a("dc00"),Object($["a"])(lt,J,H,!1,null,"41a1c1d0",null)),mt=dt.exports,ft={name:"App",components:{Catalogue:M,BasketPanel:mt}},vt=ft,pt=(a("5c0b"),Object($["a"])(vt,T,D,!1,null,null,null)),bt=pt.exports;n["a"].use(c.a,{dynamic:!0,dynamicDefaults:{clickToClose:!1}}),n["a"].config.productionTip=!1,new n["a"]({store:j,render:function(t){return t(bt)}}).$mount("#app")},dc00:function(t,e,a){"use strict";var n=a("f9ad"),o=a.n(n);o.a},e223:function(t,e,a){},ec91:function(t,e,a){"use strict";var n=a("68ea"),o=a.n(n);o.a},f694:function(t,e,a){},f9ad:function(t,e,a){}});
//# sourceMappingURL=app.db1a4c7d.js.map